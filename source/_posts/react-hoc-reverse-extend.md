---
title: Reacté«˜é˜¶ç»„ä»¶ä¹‹åå‘ç»§æ‰¿
catalog: true
date: 2019-02-20 17:18:37
subtitle:
header-img: post/11515505465_.pic_hd.jpg
tags:
- react
---
é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ç›¸ä¿¡å¤§ä¼™å„¿éƒ½ä¸é™Œç”Ÿï¼Œä½†æ˜¯å¾ˆå°‘æœ‰çœ‹åˆ°ä»‹ç»åå‘ç»§æ‰¿çš„ã€‚
å…ˆä»‹ç»èƒŒæ™¯ï¼š
åšä¸»æœ‰ä¸€éƒ¨åˆ†çš„å·¥ä½œæ—¶é—´æ˜¯åœ¨å¼€å‘å†…éƒ¨ä½¿ç”¨çš„ç®¡ç†ç³»ç»Ÿçš„ï¼Œæ¸æ¸å‘ç°ï¼Œ90%çš„é¡µé¢å…·æœ‰ç±»ä¼¼çš„UIï¼Œåƒè¿™æ ·
![](WX20190220-172517.png)
é…åˆè‡ªç ”çš„æ¡†æ¶+ant designï¼Œå…¶å®å®ç°èµ·æ¥å·²ç»éå¸¸çš„å®¹æ˜“äº†ï¼Œç¼–è¾‘å¥½`searchFields`ï¼Œ`columnsFields`ï¼Œç„¶åç»„ç»‡æ•°æ®å°±èƒ½æ¸²æŸ“å‡ºæœç´¢è¡¨å•å’Œæ•°æ®åˆ—è¡¨é¡¹ã€‚æœ‰çš„ç„¶åå¤§éƒ¨åˆ†é¡µé¢æœ‰æ“ä½œï¼Œå®¡æ ¸ã€ç¼–è¾‘ç­‰ç­‰ã€‚ä½†æ˜¯å‡ ä¹æ¯åšä¸€ä¸ªé¡µé¢å°±è¦é‡å¤ä¸€æ¬¡ä¸Šé¢çš„æ“ä½œï¼Œæœ‰äº›ç›¸åŒçš„æ“ä½œï¼Œä¸€ç›´åšå°±ä¼šè®©äººå¾ˆçƒ¦èºï¼Œæœ¬ç€è§£æ”¾éƒ¨åˆ†åŠ³åŠ¨åŠ›çš„ç›®æ ‡ï¼Œå¼€å§‹ç¼–å†™é«˜é˜¶ç»„ä»¶ã€‚

æœ€å¼€å§‹çš„ç‰ˆæœ¬å¹¶ä¸çŸ¥é“**åå‘ç»§æ‰¿**æ“ä½œï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬
```jsx
function enhanceProps(config) {
  const {
    // ä¸€äº›é…ç½®
  } = config;
  return WrappedComponent => class extends React.Component {
    // ...

    render() {
      const {
        // .....
        // ç»“æ„å‡ºä¸€äº›æ•°æ®
      } = this.props;

      const tableProps = {
        // ...ç¼–è¾‘tableçš„props
      };

      const searchBarProps = {
        // ...ç¼–è¾‘searchBarçš„props
      };

      // å¯¹åŸå…ˆçš„propsè¿›è¡Œæ‰©å±•
      const props = {
        ...this.props,
        enhanceProps: {
          tableProps,
          searchBarProps,
        }
      };

      return <WrappedComponent {...props} />;
    }
  }
}
```
ç„¶åæ˜¯ä½¿ç”¨å®ƒ
```jsx
@enhanceProps()
class Page extends React.PureComponent {
  render() {
    const { enhanceProps } = this.props;
    return (
      <React.Fragment>
        <Searchbar {...enhanceProps.searchBarProps} />
        <Table {...enhanceProps.tableProps} />
      </React.Fragment>
    );
  }
}
```
è¿™æ ·ä¸€æ¥è™½ç„¶å‡å°‘äº†ä¸€éƒ¨åˆ†searchBarPropså’ŒtablePropsçš„ç¼–è¾‘ï¼Œä½†æ˜¯è¿˜æ˜¯å°‘ä¸äº†å»æ‰‹åŠ¨æ¸²æŸ“`Searchbar`å’Œ`Table`ã€‚
>Q: ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨é«˜é˜¶å‡½æ•°é‡Œç›´æ¥æ¸²æŸ“å‘¢ï¼Ÿ
>A: ä¸åˆ©äºæ‰©å±•ï¼Œå› ä¸ºæ¯ä¸ªé¡µé¢è¡¨æ ¼æœ€åä¸€åˆ—çš„æ“ä½œä¸ä¸€æ ·ï¼Œéœ€è¦æ³¨å…¥åˆ°tablePropsé‡Œé¢ï¼Œå¹¶ä¸”ä¹Ÿä¸èƒ½é€šè¿‡é«˜é˜¶å‡½æ•°çš„é…ç½®ä¼ å…¥ï¼Œå› ä¸ºæ— æ³•æ ¹æ®reactçš„çŠ¶æ€å˜åŒ–æ¥æ›´æ–°æ•°æ®

æ‰€ä»¥ä¸Šé¢é‚£ä¸ªæ–¹å¼å¯¼è‡´äº†æˆ‘ä»¬ä½¿ç”¨å®ƒçš„æ„æ„¿ä¸æ˜¯å¾ˆå¼ºï¼Œå› ä¸ºå¹¶æ²¡æœ‰è§£æ”¾æ‰è¿™äº›å¤šæ¬¡é‡å¤çš„æ ·æ¿ä»£ç ã€‚ç»è¿‡ä¸€ç•ªæœç´¢åå‘ç°äº†é«˜é˜¶å‡½æ•°çš„**åå‘ç»§æ‰¿**è¿™ä¸€ä½¿ç”¨æ–¹å¼ï¼Œç®€å•æ¥è¯´å…¶å®å°±æ˜¯å½“å‰ç»„ä»¶ä¼šè¢«å½“ä½œâ€œçˆ¶ç±»æ¥ä½¿ç”¨â€ï¼Œæ¸²æŸ“å‡ºå£äº¤ç”±é«˜é˜¶ç»„ä»¶æ¥æ‰¿æ‹…ã€‚è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯:
>æˆ‘ä»¬å¯ä»¥å£°æ˜å¼çš„æä¾›ä¸€äº›å‡½æ•°æˆ–å±æ€§ç»™é«˜é˜¶å‡½æ•°ä½¿ç”¨ï¼Œè€Œé«˜é˜¶å‡½æ•°ä¹Ÿå¯ä»¥ç›´æ¥æ•°æ®æŠ½è±¡å‡ºçš„éƒ¨åˆ†ï¼Œä»¥è¾¾åˆ°å®Œå…¨è§£æ”¾æ‰‹åŠ¨å»render SearchBarå’Œtable

äºæ˜¯åé¢æ”¹è¿›åæˆäº†è¿™æ ·
```jsx
function withBasePage(config) {
  const {
    // è¿˜æ˜¯ä¸€äº›é…ç½®
  } = config;
  return WrappedComponent => class extends WrappedComponent {
    static displayName = `withBasePage(${WrappedComponent.displayName || WrappedComponent.name})`

    render() {
      const {
        // ç»“æ„å‡ºä¸€äº›æ•°æ®
        // .....
      } = this.props;

      const tableProps = {
        // ...ç¼–è¾‘tableçš„props
        // ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ç›´æ¥å–å¾—ä»çˆ¶ç±»ç»§æ‰¿è¿‡æ¥çš„å±æ€§
        operateField = this.operateField
        // more ...
      };

      const searchBarProps = {
        // ...ç¼–è¾‘searchBarçš„props
      };

      return (
        <React.Fragment>
          <Searchbar {...searchBarProps} />
          <Table {...tableProps} />
          {super.render()}
        </React.Fragment>
      );
    }
  };
}
```
å¦‚æœæ˜¯ä¸€äº›é™æ€çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡configä¼ å…¥ï¼Œå¦‚æœæ˜¯åŠ¨æ€çš„ï¼Œå°±å¯ä»¥é€šè¿‡å£°æ˜å‡½æ•°çš„å½¢å¼å£°æ˜åœ¨ç±»ä¸Šï¼Œç”šè‡³æˆ‘ä»¬å¯ä»¥ç›´æ¥å…¨éƒ¨å£°æ˜åœ¨ç»„ä»¶ä¸Šï¼Œç„¶åé«˜é˜¶ç»„ä»¶é€šè¿‡`this`å–å¾—ï¼Œå¦‚æœé¡µé¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ï¼Œå°±åªæœ‰æŸ¥è¯¢åŠŸèƒ½ï¼Œæˆ‘ä»¬é…ç½®å¥½searchFieldså’ŒcolumnsFieldsåå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·
```js
@withBasePage()
class Page extends PureComponent {
  render() {
    return null;
  }
}
```
å…¶ä»–çš„å°±ä»€ä¹ˆéƒ½ä¸ç”¨åšäº†

#### æ€»ç»“
æ™®é€šçš„é«˜é˜¶å‡½æ•°åªèƒ½æå‰å¤„ç†propsï¼Œç»„ä»¶åé¢çš„äº‹å°±æ— æ³•å¹²æ¶‰äº†ã€‚
ä½¿ç”¨åå‘ç»§æ‰¿ä¸ä»…å¯ä»¥æ»¡è¶³å‰é¢çš„åŠŸèƒ½ï¼Œè¿˜èƒ½åç½®å¤„ç†ç»„ä»¶çš„renderï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹éå¸¸çš„æœ‰ç”¨å’Œçµæ´»ã€‚
å‰è€…æ›´é€‚åˆå¯¹ç»„ä»¶çš„å±æ€§çš„é¢„å¤„ç†ï¼Œåè€…åˆ™é€‚åˆé«˜é˜¶ç»„ä»¶éœ€è¦ä»è¢«ä¿®é¥°çš„ç»„ä»¶å®ä¾‹ä¸­è®¿é—®æŸäº›å±æ€§å’Œæ–¹æ³•æ—¶ä½¿ç”¨ã€‚
