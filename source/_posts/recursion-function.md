---
title: ä½¿ç”¨é€’å½’å‡½æ•°å¯¹æ ‘å½¢èœå•è¿›è¡Œæœç´¢
catalog: true
date: 2017-11-24 13:55:24
subtitle: 
header-img: post/IMG_3161.JPG
tags:
- recursion
---

ä¹‹å‰å¯¹é€’å½’å‡½æ•°çš„ç†è§£è¿˜ä»…ä»…åœç•™åœ¨ä¹¦é¢ï¼Œå°±æ˜¯è¯´ä»æ¥æ²¡æœ‰åœ¨å®é™…ä¸­ç”¨åˆ°è¿‡ï¼Œä¸çŸ¥é“æ˜¯è¿æ°”å¥½è¿˜æ˜¯è¿æ°”ä¸å¥½ï¼Œåšäº†è¿™ä¹ˆä¹…å¼€å‘å±…ç„¶æ²¡ç¢°åˆ°è¿™ç§éœ€æ±‚ã€‚ä¸è¿‡å€’æ˜¯åœ¨`jQuery`çš„æºç é‡Œç›®ç¹äº†ä½¿ç”¨é€’å½’ç®—æ³•çš„åœ°æ–¹ï¼Œ`jQuery.extend`æ–¹æ³•ç›¸ä¿¡å¾ˆå¤šé«˜ç©éƒ½ç”¨è¿‡ï¼Œç”¨äºæ‹·è´å¯¹è±¡ï¼Œå¹¶ä¸”æä¾›äº†æ·±æ‹·è´ï¼Œè¿™é‡Œçš„é€’å½’å°±æ˜¯ä¸ºäº†èƒ½å¤Ÿéå†å¯¹è±¡å†…çš„å¯¹è±¡å†…çš„å¯¹è±¡å†…çš„å¯¹è±¡...ï¼Œè¿™ç§æ•°æ®æˆ‘ä»¬æ€»ä¸èƒ½ä¸€ç›´å†™ä¸‹å»æŠŠ ğŸ˜‚ï¼Œå†µä¸”é€»è¾‘è¿˜æ˜¯é‡å¤çš„ã€‚æ‰€ä»¥è¿™é‡Œä½¿ç”¨é€’å½’ç®—æ³•å°±å·§å¦™çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚è¿‘æ—¥æœ‹å‹åœ¨è§£å†³ä¸€ä¸ªèœå•æœç´¢æ—¶é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¹ˆä¸ªæ ·å­

![æ•ˆæœå›¾](20171124140432.jpg)

éœ€æ±‚æ˜¯åŒ¹é…åˆ°å…³é”®å­—çš„èœå•åŠå…¶å­èœå•æ˜¾ç¤ºå‡ºæ¥ï¼Œå°±æ˜¯è¯´åªè¦å½“å‰çš„èœå•é¡¹åŒ¹é…åˆ°äº†ï¼Œé‚£å­èœå•ä¹Ÿå…¨éƒ¨æ˜¾ç¤ºã€‚
å¤©çœŸçš„æˆ‘ä»¥ä¸ºç”¨ä¸ª`[].fitler`å‡½æ•°å°±è¡Œäº†ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°äº†æ•°æ®æ˜¯è¿™æ ·çš„
```json
[ {
  text: "èœå•1",
  nodes: [ {
    text: "èœå•1â€”èœå•1"
    nodes: ...
  }, {
    text: "èœå•1â€”èœå•2"
    nodes: ...
  } ]
}, {
  text: "èœå•2",
  nodes: [ {
    text: "èœå•2â€”èœå•1"
    nodes: ...
  } ]
} ]
```
å°±æ˜¯è¯´ä¸çŸ¥é“èœå•é‡Œæœ‰å¤šå°‘å­èœå•ï¼Œæ‰€ä»¥å»éå†å°±å¿…é¡»å¾—ç”¨é€’å½’è°ƒç”¨ï¼Œå°†ç¬¦åˆæ¡ä»¶çš„èœå•ä¿ç•™ï¼Œå¥½åœ¨æœ€åè§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢è´´å‡ºä»£ç 

```js
/**
 * 
 * @param {*} arrayData éœ€è¦é€’å½’çš„æ•°æ® 
 * @param {*} searchText æœç´¢å…³é”®å­—
 */
function recursionSearch( arrayData, searchText ) {
  // å£°æ˜ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œä¸å»æ“ä½œåŸå…ˆçš„æ•°æ®
  let newArry = [];
  // ç¬¬ä¸€å±‚æ•°æ®ç›´æ¥æ˜¯èœå•ï¼Œæ‰€ä»¥ä¸éœ€è¦å–nodes
  arrayData = arrayData.nodes || arrayData
  // å¾ªç¯è¯»å–èœå•æ•°æ®
  for ( let i = 0, item; item = arrayData[ i++ ]; ) {

    // èœå•åç§°æ¨¡ç³ŠæŸ¥è¯¢
    if ( item.text && item.text.indexOf( searchText ) > -1 ) {
      // æ¡ä»¶æ»¡è¶³å°±ç›´æ¥ä¿ç•™ï¼Œä¸éœ€è¦å†éå†æŸ¥æ‰¾å­èœå•çš„é¡¹ç›®
      newArry.push( item );
    } else {
      // åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å­èœå•
      if ( item.nodes ) {
        // å­èœå•å­˜åœ¨ï¼Œå†èµ°ä¸€æ¬¡è¿™ä¸ªæµç¨‹ï¼Œå°†ç­›é€‰å‡ºæ¥çš„æ•°æ®ç›´æ¥é‡æ–°èµ‹å€¼ç»™nodes
        let result = recursionSearch( item, searchText );
        if ( result.length ) {
          item.nodes = result;
          // å°†ç»“æœæ”¾è¿›æ–°çš„item
          newArry.push( item )
        }
      }
    }
  }
  // æŠŠç­›é€‰ç»“æœè¿”å›å‡ºå»
  return newArry;
}
```
ç»“æœç»ˆç©¶æ˜¯å‡ºæ¥äº†ï¼Œå±…ç„¶èŠ±äº†ä¸€ä¸ªå¤šå°æ—¶ï¼Œä¸­é—´ä¸€åº¦è¦æ”¾å¼ƒäº†ï¼Œä½†æ˜¯ç§‰ç€â€œè€å¸æœºâ€çš„å…‰ç¯åšæŒå¼„å‡ºæ¥äº†ï¼Œè¿˜æ˜¯è›®å¼€å¿ƒçš„ã€‚ä»¤äººæ±—é¢œçš„æ˜¯èŠ±äº†è¿™ä¹ˆä¹…ã€‚(lllï¿¢Ï‰ï¿¢)

//-----------------æ›´æ–°----------------
å¦‚æœè¿™é‡Œéœ€æ±‚å˜äº†ï¼Œä¸å†æŒ‰ç…§titleæ¥æ£€ç´¢ï¼Œè€Œæ˜¯æ£€ç´¢disabledçš„é¡¹ç›®ï¼Œæˆ–è€…å…¶ä»–æ¡ä»¶å‘¢ï¼Œä¸Šé¢çš„é€’å½’å‡½æ•°åˆ™éœ€è¦å˜åŠ¨ä¸€ä¸‹ï¼Œå°†æ£€ç´¢æ¡ä»¶å¼€æ”¾å‡ºæ¥ç”±è°ƒç”¨è€…è‡ªå·±æ¥å†³å®š
```js
function recursionFilter( arrayData, filter ) {
  let newArry = [];
  arrayData = arrayData.nodes || arrayData
  for ( let i = 0, item; item = arrayData[ i++ ]; ) {

    if ( filter( item ) ) {
      newArry.push( item );
    } else {
      if ( item.nodes ) {
        let result = recursionFilter( item, filter );
        if ( result.length ) {
          item.nodes = result;
          newArry.push( item )
        }
      }
    }
  }
  return newArry;
}

// è°ƒç”¨è€…
let result = recursionFilter( treeData, function( item ) {
  return item.state.check === true
} )
```
`filter`å‚æ•°å°±æ˜¯è°ƒç”¨è€…ä¼ é€’çš„å›è°ƒå‚æ•°ï¼Œæ‰§è¡Œçš„ç»“æœåº”è¯¥æ˜¯ä¸€ä¸ªbooleanå€¼æ¥ç¡®å®šå½“å‰é¡¹ç›®æ˜¯å¦ç¬¦åˆæ£€ç´¢æ¡ä»¶ã€‚

